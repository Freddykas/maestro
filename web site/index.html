<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAMUSEL - Plateforme ONG</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --main-blue: #1e3a8a;
            --light-blue: #dbeafe;
            --bg-gray: #f0f2f5;
            --border-color: #e2e8f0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg-gray); height: 100vh; display: flex; overflow: hidden; }

        /* BARRE LATERALE GAUCHE (ICONES) */
        .side-icons { width: 60px; background: #f0f2f5; border-right: 1px solid var(--border-color); display: flex; flex-direction: column; align-items: center; padding: 15px 0; }
        .side-icons i { font-size: 22px; color: #54656f; margin-bottom: 25px; cursor: pointer; transition: 0.3s; }
        .side-icons i:hover { color: var(--main-blue); }
        .user-mini-avatar { width: 35px; height: 35px; border-radius: 50%; object-fit: cover; margin-top: auto; cursor: pointer; border: 2px solid transparent; }
        .user-mini-avatar:hover { border-color: var(--main-blue); }

        /* LISTE DES DISCUSSIONS */
        .sidebar-list { width: 30%; min-width: 300px; background: white; border-right: 1px solid var(--border-color); display: flex; flex-direction: column; resize: horizontal; overflow: auto; }
        .sidebar-header { padding: 15px; background: #f0f2f5; }
        .logo-area { display: flex; align-items: center; gap: 10px; font-weight: bold; color: var(--main-blue); margin-bottom: 15px; }
        .logo-area img { width: 30px; height: 30px; border-radius: 5px; }
        .search-box { background: white; border-radius: 8px; padding: 8px 15px; display: flex; align-items: center; gap: 10px; border: 1px solid #eef0f2; }
        .search-box input { border: none; outline: none; width: 100%; font-size: 14px; }

        .contacts-scroll { flex: 1; overflow-y: auto; }
        .contact-item { display: flex; padding: 12px 15px; align-items: center; gap: 15px; border-bottom: 1px solid #f8fafc; cursor: pointer; }
        .contact-item:hover { background: #f5f6f6; }
        .contact-avatar { width: 45px; height: 45px; border-radius: 50%; background: var(--main-blue); color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }

        /* ZONE DE CHAT PRINCIPALE */
        .chat-area { flex: 1; display: flex; flex-direction: column; background: #efeae2; position: relative; }
        .chat-header { background: #f0f2f5; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border-color); }
        .current-user-info { display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .chat-messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; background-image: none !important; background-color: #efeae2; } /* Suppression gribouillage */
        
        /* VOLET INFOS DROITE */
        #info-panel { width: 350px; background: white; border-left: 1px solid var(--border-color); display: none; flex-direction: column; overflow-y: auto; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
        .info-header { padding: 20px; display: flex; align-items: center; gap: 20px; font-weight: bold; border-bottom: 1px solid var(--border-color); }
        .info-content { padding: 20px; text-align: center; }
        .big-avatar { width: 200px; height: 200px; border-radius: 50%; object-fit: cover; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .info-details { text-align: left; margin-top: 20px; }
        .info-details label { font-size: 12px; color: #667781; display: block; margin-top: 15px; }
        .info-details p { font-size: 15px; color: #111b21; border-bottom: 1px solid #f0f2f5; padding-bottom: 5px; }

        /* FENETRE APPEL */
        #call-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; }
        
        /* LOGIN / CREATION COMPTE */
        #auth-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--main-blue); z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .auth-card { background: white; padding: 30px; border-radius: 15px; width: 400px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .auth-card input, .auth-card select { width: 100%; padding: 12px; margin-top: 10px; border: 1px solid #ccc; border-radius: 8px; }
        .auth-btn { background: var(--main-blue); color: white; width: 100%; padding: 15px; border: none; border-radius: 8px; margin-top: 20px; cursor: pointer; font-weight: bold; }

        /* BARRE DE SAISIE */
        .input-bar { background: #f0f2f5; padding: 10px 20px; display: flex; align-items: center; gap: 15px; }
        .input-bar input { flex: 1; padding: 12px; border-radius: 8px; border: none; outline: none; }
    </style>
</head>
<body>

    <div id="auth-overlay">
        <div class="auth-card" id="auth-content">
            <h2 style="color:var(--main-blue); text-align: center;">Rejoindre MAMUSEL</h2>
            <div id="step-1">
                <input type="email" id="auth-email" placeholder="Votre Email Personnel">
                <input type="text" id="auth-nom" placeholder="Nom Complet">
                <input type="date" id="auth-birth" title="Date de naissance">
                <input type="text" id="auth-poste" placeholder="Poste occupé dans l'ONG">
                <h4 style="margin-top:15px; font-size: 14px; color: #666;">Domicile :</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <input type="text" id="dom-pays" placeholder="Pays">
                    <input type="text" id="dom-commune" placeholder="Commune">
                    <input type="text" id="dom-quartier" placeholder="Quartier">
                    <input type="text" id="dom-avenue" placeholder="Avenue">
                </div>
                <button class="auth-btn" onclick="goToConfirm()">CRÉER MON COMPTE</button>
            </div>
            <div id="step-2" style="display:none;">
                <p style="margin-bottom: 10px; font-size: 14px;">Un code a été envoyé à votre email. Entrez le code secret :</p>
                <input type="password" id="secret-code" placeholder="Code secret">
                <button class="auth-btn" onclick="finishAuth()">CONFIRMER</button>
                <button onclick="location.reload()" style="background:none; border:none; color:grey; width:100%; margin-top:10px; cursor:pointer;">Annuler</button>
            </div>
        </div>
    </div>

    <div class="side-icons">
        <i class="fas fa-comment-dots" title="Discussions"></i>
        <i class="fas fa-video" title="Appels" onclick="openCallScreen()"></i>
        <i class="fas fa-folder-open" id="btn-media" title="Médiathèque" onclick="alert('Médiathèque MAMUSEL ouverte')"></i>
        <i class="fas fa-cog" title="Paramètres"></i>
        <i class="fas fa-sign-out-alt" style="margin-top: 20px; color: #ef4444;" title="Déconnexion" onclick="logout()"></i>
        <img src="https://via.placeholder.com/150" class="user-mini-avatar" id="my-small-avatar" onclick="toggleInfoPanel(true, true)">
    </div>

    <div class="sidebar-list">
        <div class="sidebar-header">
            <div class="logo-area">
                <img src="https://cdn-icons-png.flaticon.com/512/3064/3064155.png" alt="Logo"> 
                MAMUSEL
            </div>
            <div class="search-box">
                <i class="fas fa-search" style="color: #667781;"></i>
                <input type="text" placeholder="Rechercher un membre de l'ONG...">
            </div>
        </div>
        <div class="contacts-scroll" id="contacts-list">
            </div>
    </div>

    <div class="chat-area">
        <div class="chat-header">
            <div class="current-user-info" onclick="toggleInfoPanel(true, false)">
                <div class="contact-avatar" id="chat-header-avatar">?</div>
                <div>
                    <h4 id="chat-header-name">Sélectionnez une discussion</h4>
                    <span style="font-size: 12px; color: #667781;" id="chat-header-status">cliquez pour voir le profil</span>
                </div>
            </div>
            <div style="display:flex; gap: 20px; color: #54656f;">
                <i class="fas fa-search" style="cursor:pointer;"></i>
                <i class="fas fa-ellipsis-v" style="cursor:pointer;" onclick="confirmDeleteAccount()"></i>
            </div>
        </div>

        <div class="chat-messages" id="chat-messages-box">
            </div>

        <div class="input-bar">
            <i class="far fa-smile icon-btn"></i>
            <i class="fas fa-paperclip icon-btn" onclick="document.getElementById('file-input').click()"></i>
            <input type="file" id="file-input" style="display:none" onchange="alert('Fichier prêt à l\'envoi')">
            <input type="text" id="msg-input" placeholder="Écrire à l'ONG...">
            <i class="fas fa-microphone icon-btn" onclick="alert('Enregistrement vocal...')"></i>
        </div>
    </div>

    <div id="info-panel">
        <div class="info-header">
            <i class="fas fa-times" style="cursor:pointer;" onclick="toggleInfoPanel(false)"></i>
            <span>Infos du membre</span>
        </div>
        <div class="info-content">
            <img src="https://via.placeholder.com/200" class="big-avatar" id="info-avatar">
            <h2 id="info-name">Freddy Kasongo</h2>
            <p id="info-tag-me" style="color: var(--main-blue); font-weight: bold; display: none;">(vous)</p>
            
            <div class="info-details">
                <label>POSTE DANS L'ONG</label>
                <p id="info-role">Directeur Général</p>
                
                <label>ADRESSE EMAIL</label>
                <p id="info-mail">contact@mamusel.com</p>
                
                <label>TÉLÉPHONE</label>
                <p id="info-tel">+33 7 53 92 44 83</p>

                <label>DATE DE NAISSANCE</label>
                <p id="info-date">15/01/1995</p>

                <label>ADRESSE DE DOMICILE</label>
                <p id="info-domicile">France, Paris, Bastille, Rue du Port</p>
                
                <button style="margin-top: 30px; color: red; border: none; background: none; cursor: pointer;" onclick="alert('Action Corbeille: Suppression des documents')">
                    <i class="fas fa-trash-alt"></i> Vider la corbeille des documents
                </button>
            </div>
        </div>
    </div>

    <div id="call-screen">
        <img src="https://via.placeholder.com/150" class="big-avatar" style="border: 4px solid white;">
        <h1 id="call-name">Appel en cours...</h1>
        <div style="display:flex; gap: 30px; margin-top: 50px;">
            <button class="btn-call" style="background:#ef4444; width:70px; height:70px; border-radius:50%; border:none; color:white;" onclick="closeCallScreen()">
                <i class="fas fa-phone-slash fa-2x"></i>
            </button>
            <button class="btn-call" style="background:#22c55e; width:70px; height:70px; border-radius:50%; border:none; color:white;">
                <i class="fas fa-microphone fa-2x"></i>
            </button>
        </div>
    </div>

    <script>
        // DONNÉES SIMULÉES
        let currentUser = JSON.parse(localStorage.getItem('mamusel_user')) || null;
        const members = [
            { id: 1, name: "Serge Mbala", role: "Secrétaire", mail: "serge@ong.com", tel: "+33 6...", birth: "12/05/1990", dom: "RDC, Kinshasa, Gombe, Av. Paix" },
            { id: 2, name: "Maman", role: "Trésorière", mail: "maman@ong.com", tel: "+33 7...", birth: "01/01/1970", dom: "France, Lyon, Centre, Rue Joie" },
            { id: 3, name: "Lumière de feu", role: "Coordonnateur", mail: "lumiere@ong.com", tel: "+33 6...", birth: "20/11/1988", dom: "Belgique, Bruxelles, Nord, Rue Espoir" }
        ];

        // INITIALISATION
        window.onload = () => {
            if (currentUser) {
                document.getElementById('auth-overlay').style.display = 'none';
                loadContacts();
            }
        };

        function loadContacts() {
            const list = document.getElementById('contacts-list');
            list.innerHTML = "";
            members.forEach(m => {
                const item = document.createElement('div');
                item.className = "contact-item";
                item.onclick = () => selectChat(m);
                item.innerHTML = `
                    <div class="contact-avatar">${m.name.charAt(0)}</div>
                    <div style="flex:1">
                        <h4>${m.name}</h4>
                        <p style="font-size:12px; color:grey">${m.role}</p>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function selectChat(member) {
            document.getElementById('chat-header-name').innerText = member.name;
            document.getElementById('chat-header-avatar').innerText = member.name.charAt(0);
            document.getElementById('chat-header-status').innerText = "En ligne";
            
            // Préparer les infos pour le volet de droite
            updateInfoPanel(member, false);
        }

        function toggleInfoPanel(show, isMe = false) {
            const panel = document.getElementById('info-panel');
            panel.style.display = show ? 'flex' : 'none';
            if(isMe) updateInfoPanel(currentUser, true);
        }

        function updateInfoPanel(user, isMe) {
            document.getElementById('info-name').innerText = user.name;
            document.getElementById('info-role').innerText = user.role || user.poste;
            document.getElementById('info-mail').innerText = user.mail || user.email;
            document.getElementById('info-tel').innerText = user.tel || "Non renseigné";
            document.getElementById('info-date').innerText = user.birth || user.dateBirth;
            document.getElementById('info-domicile').innerText = user.dom || `${user.pays}, ${user.commune}, ${user.quartier}, ${user.avenue}`;
            document.getElementById('info-tag-me').style.display = isMe ? 'block' : 'none';
        }

        // AUTHENTIFICATION
        function goToConfirm() {
            const email = document.getElementById('auth-email').value;
            if(!email) return alert("Entrez votre email");
            document.getElementById('step-1').style.display = 'none';
            document.getElementById('step-2').style.display = 'block';
        }

        function finishAuth() {
            const code = document.getElementById('secret-code').value;
            if(code === "mamusel est mon entreprise") {
                const user = {
                    name: document.getElementById('auth-nom').value,
                    email: document.getElementById('auth-email').value,
                    poste: document.getElementById('auth-poste').value,
                    dateBirth: document.getElementById('auth-birth').value,
                    pays: document.getElementById('dom-pays').value,
                    commune: document.getElementById('dom-commune').value,
                    quartier: document.getElementById('dom-quartier').value,
                    avenue: document.getElementById('dom-avenue').value
                };
                localStorage.setItem('mamusel_user', JSON.stringify(user));
                location.reload();
            } else {
                alert("Code incorrect");
            }
        }

        function logout() {
            if(confirm("Voulez-vous vous déconnecter ?")) {
                localStorage.removeItem('mamusel_user');
                location.reload();
            }
        }

        function confirmDeleteAccount() {
            if(confirm("ATTENTION : Supprimer définitivement votre compte MAMUSEL ?")) {
                localStorage.clear();
                location.reload();
            }
        }

        // APPELS
        function openCallScreen() { document.getElementById('call-screen').style.display = 'flex'; }
        function closeCallScreen() { document.getElementById('call-screen').style.display = 'none'; }
    </script>
</body>
</html>
